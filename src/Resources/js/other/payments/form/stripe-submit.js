"use strict";!function(){var e,t,r,n,a,o="#VARIABLES#",c=o.id,i=o.formAnchor,d=o.currencySelector,m=(o.currencyFixed,o.amountSelector),u=(o.amountFixed,o.publicKey),s=o.usage,l=document.querySelector('form[data-id="'.concat(i,'"]')),f=!1;if(!l||!l.freeform)return console.error("Could not attach payments to Freeform plugin"),!1;l.freeform.setOption("ajax",!0),l.freeform.addOnSubmitCallback(function(){if(l.freeform.lockSubmit(),l.freeform._removeMessages(),!Freeform.paymentsScript)return console.log("Stripe scripts not loaded yet"),l.freeform.unlockSubmit(),!1;if(f)return!0;var t=document.getElementById(c);return"single_use"===s?e.createPaymentMethod("card",r,{}).then(function(e){return e.error?p(e.error.message):(t.value=e.paymentMethod.id,f=!0,void l.dispatchEvent(h("submit")))}):e.createToken(r).then(function(e){return e.error?p(e.error.message):(t.value=e.token.id,f=!0,void l.dispatchEvent(h("submit")))}),!1}),l.freeform.addOnAfterAjaxSubmit(function(t,n,a){if(a.actions){var o=document.getElementById(c);a.actions.forEach(function(t){if("stripe.single_payment.payment_intent_action"===t.name){var a=t.metadata.payment_intent;o.value=a.id,e.handleCardAction(a.client_secret,r,{}).then(function(e){return e.error?(f=!1,p(e.error.message)):void n.dispatchEvent(h("submit"))})}if("stripe.subscription.payment_intent_action"===t.name){var c=t.metadata,i=c.subscription,d=c.payment_intent;o.value=i.id,e.handleCardPayment(d.client_secret,r,{}).then(function(e){return e.error?(f=!1,p(e.error.message)):void n.dispatchEvent(h("submit"))})}})}});var p=function(e){return l.freeform._renderFormErrors([e]),l.freeform.unlockSubmit(),!1};l.addEventListener("reset",function(){r&&r.clear(),a&&a.clear(),n&&n.clear()},!1);var v=function(){var o=c+"_card_number",i=c+"_card_cvc",s=c+"_card_expiry",p=document.getElementById(o),v=document.getElementById(i),y=document.getElementById(s),E=p.attributes.placeholder,g=y.attributes.placeholder,b=v.attributes.placeholder,_=h("freeform-stripe-styling");_.detail={},l.dispatchEvent(_);var S=_.detail;e=Stripe(u),t=e.elements(),r=t.create("cardNumber",{placeholder:E?E.value:"",style:S}),n=t.create("cardExpiry",{placeholder:g?g.value:"",style:S}),a=t.create("cardCvc",{placeholder:b?b.value:"",style:S}),r.mount("#"+o),n.mount("#"+s),a.mount("#"+i);var F=function(){f=!1};if(r.on("change",F),n.on("change",F),a.on("change",F),m){var k=form.querySelector(m);k&&k.addEventListener("change",F)}if(d){var x=form.querySelector(d);x&&x.addEventListener("change",F)}};if(Freeform.paymentsScript)Freeform.paymentsScript.addEventListener("load",v);else{var y=document.createElement("script");y.addEventListener("load",v),y.src="https://js.stripe.com/v3/",document.body.appendChild(y),Freeform.paymentsScript=y}var h=function(e){var t;return"function"==typeof Event?t=new Event(e):(t=document.createEvent("Event"),t.initEvent(e,!0,!0)),t}}();