!function(Q){var F={};function B(U){if(F[U])return F[U].exports;var t=F[U]={i:U,l:!1,exports:{}};return Q[U].call(t.exports,t,t.exports,B),t.l=!0,t.exports}B.m=Q,B.c=F,B.d=function(Q,F,U){B.o(Q,F)||Object.defineProperty(Q,F,{enumerable:!0,get:U})},B.r=function(Q){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},B.t=function(Q,F){if(1&F&&(Q=B(Q)),8&F)return Q;if(4&F&&"object"==typeof Q&&Q&&Q.__esModule)return Q;var U=Object.create(null);if(B.r(U),Object.defineProperty(U,"default",{enumerable:!0,value:Q}),2&F&&"string"!=typeof Q)for(var t in Q)B.d(U,t,function(F){return Q[F]}.bind(null,t));return U},B.n=function(Q){var F=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return B.d(F,"a",F),F},B.o=function(Q,F){return Object.prototype.hasOwnProperty.call(Q,F)},B.p="",B(B.s=11)}({11:function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar StripeHandler = function StripeHandler(freeform) {\n  var _this = this;\n\n  _classCallCheck(this, StripeHandler);\n\n  this.stripeSubmitReady = false;\n  this.scaTriggered = false;\n  this.stripe = void 0;\n  this.elements = void 0;\n  this.cardNumber = void 0;\n  this.cardExpiry = void 0;\n  this.cardCvc = void 0;\n  this.paymentFieldId = void 0;\n  this.currencySelector = void 0;\n  this.amountSelector = void 0;\n  this.publicKey = void 0;\n  this.usage = void 0;\n  this.freeform = void 0;\n  this.form = void 0;\n  this.stripeLoaded = false;\n\n  this._isStripePresent = function () {\n    var numberDiv = document.getElementById(_this.paymentFieldId + '_card_number');\n    return numberDiv !== null;\n  };\n\n  this._loadStripe = function () {\n    if (!window.stripeScript) {\n      var script = document.createElement('script');\n      script.addEventListener('load', _this._loadCreditCardFields);\n      script.addEventListener('load', function () {\n        _this.stripeLoaded = true;\n      });\n      script.src = 'https://js.stripe.com/v3/';\n      document.body.appendChild(script);\n      window.stripeScript = script;\n    } else {\n      _this.stripeLoaded = true;\n\n      _this._loadCreditCardFields();\n    }\n  };\n\n  this._handleSubmit = function () {\n    if (!_this._isStripePresent() || !_this.stripe) {\n      return true;\n    }\n\n    _this.freeform.lockSubmit();\n\n    _this.freeform._removeMessages();\n\n    if (!_this.stripeLoaded) {\n      console.log('Stripe scripts not loaded yet');\n\n      _this.freeform.unlockSubmit();\n\n      return false;\n    } // Return true if payments have been processed and are ready\n\n\n    if (_this.stripeSubmitReady) {\n      return true;\n    }\n\n    var cardField = document.getElementById(_this.paymentFieldId);\n\n    if (_this.usage === 'single_use') {\n      _this.stripe.createPaymentMethod('card', _this.cardNumber, {}).then(function (result) {\n        if (result.error) {\n          return _this._showError(result.error.message);\n        }\n\n        cardField.value = result.paymentMethod.id;\n        _this.stripeSubmitReady = true;\n\n        _this.freeform.triggerSubmit();\n      });\n    } else {\n      _this.stripe.createToken(_this.cardNumber).then(function (result) {\n        if (result.error) {\n          return _this._showError(result.error.message);\n        }\n\n        cardField.value = result.token.id;\n        _this.stripeSubmitReady = true;\n\n        _this.freeform.triggerSubmit();\n      });\n    }\n\n    return false;\n  };\n\n  this._handleAfterSubmit = function (event, form, response) {\n    if (!_this._isStripePresent() || !_this.stripe) {\n      return true;\n    }\n\n    if (response.actions) {\n      var cardField = document.getElementById(_this.paymentFieldId);\n      response.actions.forEach(function (action) {\n        if (action.name === 'stripe.single_payment.payment_intent_action') {\n          var payment_intent = action.metadata.payment_intent;\n          _this.scaTriggered = true;\n          cardField.value = payment_intent.id;\n\n          _this.stripe.handleCardAction(payment_intent.client_secret, _this.cardNumber, {}).then(function (result) {\n            if (result.error) {\n              _this.stripeSubmitReady = false;\n              return _this._showError(result.error.message);\n            }\n\n            _this.freeform.triggerSubmit();\n          });\n        }\n\n        if (action.name === 'stripe.subscription.payment_intent_action') {\n          var _action$metadata = action.metadata,\n              subscription = _action$metadata.subscription,\n              _payment_intent = _action$metadata.payment_intent;\n          _this.scaTriggered = true;\n          cardField.value = subscription.id;\n\n          _this.stripe.handleCardPayment(_payment_intent.client_secret, cardNumber, {}).then(function (result) {\n            if (result.error) {\n              _this.stripeSubmitReady = false;\n              return _this._showError(result.error.message);\n            }\n\n            _this.freeform.triggerSubmit();\n          });\n        }\n      });\n    }\n  };\n\n  this._showError = function (message) {\n    _this.freeform._renderFormErrors([message]);\n\n    _this.freeform.unlockSubmit();\n\n    return false;\n  };\n\n  this._loadCreditCardFields = function () {\n    if (!_this._isStripePresent()) {\n      return;\n    }\n\n    var numberDivId = _this.paymentFieldId + '_card_number';\n    var cvcDivId = _this.paymentFieldId + '_card_cvc';\n    var expiryDivId = _this.paymentFieldId + '_card_expiry';\n    var numberDiv = document.getElementById(numberDivId);\n    var cvcDiv = document.getElementById(cvcDivId);\n    var expiryDiv = document.getElementById(expiryDivId);\n    var numberPlaceholder = numberDiv.attributes.placeholder;\n    var expiryPlaceholder = expiryDiv.attributes.placeholder;\n    var cvcPlaceholder = cvcDiv.attributes.placeholder;\n\n    var event = _this.freeform._createNewEvent('freeform-stripe-styling');\n\n    event.detail = {};\n\n    _this.form.dispatchEvent(event);\n\n    var style = event.detail; // eslint-disable-next-line no-undef\n\n    _this.stripe = Stripe(_this.publicKey);\n    _this.elements = _this.stripe.elements();\n    _this.cardNumber = _this.elements.create('cardNumber', {\n      placeholder: numberPlaceholder ? numberPlaceholder.value : '',\n      style: style\n    });\n    _this.cardExpiry = _this.elements.create('cardExpiry', {\n      placeholder: expiryPlaceholder ? expiryPlaceholder.value : '',\n      style: style\n    });\n    _this.cardCvc = _this.elements.create('cardCvc', {\n      placeholder: cvcPlaceholder ? cvcPlaceholder.value : '',\n      style: style\n    });\n\n    _this.cardNumber.mount('#' + numberDivId);\n\n    _this.cardExpiry.mount('#' + expiryDivId);\n\n    _this.cardCvc.mount('#' + cvcDivId);\n\n    _this.cardNumber.on('change', _this._resetStripeSubmit);\n\n    _this.cardExpiry.on('change', _this._resetStripeSubmit);\n\n    _this.cardCvc.on('change', _this._resetStripeSubmit);\n\n    _this.freeform.addOnAfterAjaxSubmit(function () {\n      if (!_this.scaTriggered) {\n        _this._resetStripeSubmit();\n      } else {\n        _this.scaTriggered = false;\n      }\n    });\n\n    if (_this.amountSelector) {\n      var amountInput = _this.form.querySelector(_this.amountSelector);\n\n      if (amountInput) {\n        amountInput.addEventListener('change', _this._resetStripeSubmit);\n      }\n    }\n\n    if (_this.currencySelector) {\n      var currencyInput = _this.form.querySelector(_this.currencySelector);\n\n      if (currencyInput) {\n        currencyInput.addEventListener('change', _this._resetStripeSubmit);\n      }\n    }\n  };\n\n  this._resetStripeSubmit = function () {\n    _this.stripeSubmitReady = false;\n  };\n\n  var form = freeform.form;\n\n  if (form.dataset.stripe === undefined) {\n    return;\n  }\n\n  this.freeform = freeform;\n  this.form = form;\n  this.paymentFieldId = form.dataset.stripePaymentFieldId;\n  this.currencySelector = form.dataset.stripeCurrencySelector;\n  this.amountSelector = form.dataset.stripeAmountSelector;\n  this.publicKey = form.dataset.stripePublicKey;\n  this.usage = form.dataset.stripeUsage;\n\n  if (!this._isStripePresent) {\n    return;\n  } // Force AJAX on the payment form\n\n\n  freeform.setOption('ajax', true);\n  freeform.addOnSubmitCallback(this._handleSubmit);\n  freeform.addOnAfterAjaxSubmit(this._handleAfterSubmit);\n\n  this._loadStripe();\n\n  form.addEventListener('reset', function () {\n    _this.cardNumber && _this.cardNumber.clear();\n    _this.cardCvc && _this.cardCvc.clear();\n    _this.cardExpiry && _this.cardExpiry.clear();\n  }, false);\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (StripeHandler);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZnJvbnQtZW5kL3BsdWdpbi9mb3JtL3N0cmlwZS1oYW5kbGVyLmpzPzg3YTMiXSwibmFtZXMiOlsiU3RyaXBlSGFuZGxlciIsImZyZWVmb3JtIiwic3RyaXBlU3VibWl0UmVhZHkiLCJzY2FUcmlnZ2VyZWQiLCJzdHJpcGUiLCJlbGVtZW50cyIsImNhcmROdW1iZXIiLCJjYXJkRXhwaXJ5IiwiY2FyZEN2YyIsInBheW1lbnRGaWVsZElkIiwiY3VycmVuY3lTZWxlY3RvciIsImFtb3VudFNlbGVjdG9yIiwicHVibGljS2V5IiwidXNhZ2UiLCJmb3JtIiwic3RyaXBlTG9hZGVkIiwiX2lzU3RyaXBlUHJlc2VudCIsIm51bWJlckRpdiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJfbG9hZFN0cmlwZSIsIndpbmRvdyIsInN0cmlwZVNjcmlwdCIsInNjcmlwdCIsImNyZWF0ZUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xvYWRDcmVkaXRDYXJkRmllbGRzIiwic3JjIiwiYm9keSIsImFwcGVuZENoaWxkIiwiX2hhbmRsZVN1Ym1pdCIsImxvY2tTdWJtaXQiLCJfcmVtb3ZlTWVzc2FnZXMiLCJjb25zb2xlIiwibG9nIiwidW5sb2NrU3VibWl0IiwiY2FyZEZpZWxkIiwiY3JlYXRlUGF5bWVudE1ldGhvZCIsInRoZW4iLCJyZXN1bHQiLCJlcnJvciIsIl9zaG93RXJyb3IiLCJtZXNzYWdlIiwidmFsdWUiLCJwYXltZW50TWV0aG9kIiwiaWQiLCJ0cmlnZ2VyU3VibWl0IiwiY3JlYXRlVG9rZW4iLCJ0b2tlbiIsIl9oYW5kbGVBZnRlclN1Ym1pdCIsImV2ZW50IiwicmVzcG9uc2UiLCJhY3Rpb25zIiwiZm9yRWFjaCIsImFjdGlvbiIsIm5hbWUiLCJwYXltZW50X2ludGVudCIsIm1ldGFkYXRhIiwiaGFuZGxlQ2FyZEFjdGlvbiIsImNsaWVudF9zZWNyZXQiLCJzdWJzY3JpcHRpb24iLCJoYW5kbGVDYXJkUGF5bWVudCIsIl9yZW5kZXJGb3JtRXJyb3JzIiwibnVtYmVyRGl2SWQiLCJjdmNEaXZJZCIsImV4cGlyeURpdklkIiwiY3ZjRGl2IiwiZXhwaXJ5RGl2IiwibnVtYmVyUGxhY2Vob2xkZXIiLCJhdHRyaWJ1dGVzIiwicGxhY2Vob2xkZXIiLCJleHBpcnlQbGFjZWhvbGRlciIsImN2Y1BsYWNlaG9sZGVyIiwiX2NyZWF0ZU5ld0V2ZW50IiwiZGV0YWlsIiwiZGlzcGF0Y2hFdmVudCIsInN0eWxlIiwiU3RyaXBlIiwiY3JlYXRlIiwibW91bnQiLCJvbiIsIl9yZXNldFN0cmlwZVN1Ym1pdCIsImFkZE9uQWZ0ZXJBamF4U3VibWl0IiwiYW1vdW50SW5wdXQiLCJxdWVyeVNlbGVjdG9yIiwiY3VycmVuY3lJbnB1dCIsImRhdGFzZXQiLCJ1bmRlZmluZWQiLCJzdHJpcGVQYXltZW50RmllbGRJZCIsInN0cmlwZUN1cnJlbmN5U2VsZWN0b3IiLCJzdHJpcGVBbW91bnRTZWxlY3RvciIsInN0cmlwZVB1YmxpY0tleSIsInN0cmlwZVVzYWdlIiwic2V0T3B0aW9uIiwiYWRkT25TdWJtaXRDYWxsYmFjayIsImNsZWFyIl0sIm1hcHBpbmdzIjoiOzs7SUFBTUEsYSxHQXFCSix1QkFBWUMsUUFBWixFQUFzQjtBQUFBOztBQUFBOztBQUFBLE9BcEJ0QkMsaUJBb0JzQixHQXBCRixLQW9CRTtBQUFBLE9BbkJ0QkMsWUFtQnNCLEdBbkJQLEtBbUJPO0FBQUEsT0FqQnRCQyxNQWlCc0I7QUFBQSxPQWhCdEJDLFFBZ0JzQjtBQUFBLE9BZnRCQyxVQWVzQjtBQUFBLE9BZHRCQyxVQWNzQjtBQUFBLE9BYnRCQyxPQWFzQjtBQUFBLE9BWHRCQyxjQVdzQjtBQUFBLE9BVnRCQyxnQkFVc0I7QUFBQSxPQVR0QkMsY0FTc0I7QUFBQSxPQVJ0QkMsU0FRc0I7QUFBQSxPQVB0QkMsS0FPc0I7QUFBQSxPQUx0QlosUUFLc0I7QUFBQSxPQUp0QmEsSUFJc0I7QUFBQSxPQUZ0QkMsWUFFc0IsR0FGUCxLQUVPOztBQUFBLE9BcUN0QkMsZ0JBckNz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QUFJLENBQUN3RSxPQUFMLENBQWFLLGVBQTlCO0FBQ0EsT0FBSzlFLEtBQUwsR0FBYUMsSUFBSSxDQUFDd0UsT0FBTCxDQUFhTSxXQUExQjs7QUFFQSxNQUFJLENBQUMsS0FBSzVFLGdCQUFWLEVBQTRCO0FBQzFCO0FBQ0QsR0FqQm1CLENBbUJwQjs7O0FBQ0FmLFVBQVEsQ0FBQzRGLFNBQVQsQ0FBbUIsTUFBbkIsRUFBMkIsSUFBM0I7QUFDQTVGLFVBQVEsQ0FBQzZGLG1CQUFULENBQTZCLEtBQUtoRSxhQUFsQztBQUNBN0IsVUFBUSxDQUFDaUYsb0JBQVQsQ0FBOEIsS0FBS2pDLGtCQUFuQzs7QUFFQSxPQUFLN0IsV0FBTDs7QUFFQU4sTUFBSSxDQUFDVyxnQkFBTCxDQUNFLE9BREYsRUFFRSxZQUFNO0FBQ0osU0FBSSxDQUFDbkIsVUFBTCxJQUFtQixLQUFJLENBQUNBLFVBQUwsQ0FBZ0J5RixLQUFoQixFQUFuQjtBQUNBLFNBQUksQ0FBQ3ZGLE9BQUwsSUFBZ0IsS0FBSSxDQUFDQSxPQUFMLENBQWF1RixLQUFiLEVBQWhCO0FBQ0EsU0FBSSxDQUFDeEYsVUFBTCxJQUFtQixLQUFJLENBQUNBLFVBQUwsQ0FBZ0J3RixLQUFoQixFQUFuQjtBQUNELEdBTkgsRUFPRSxLQVBGO0FBU0QsQzs7QUFvTVkvRiw0RUFBZiIsImZpbGUiOiIxMS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFN0cmlwZUhhbmRsZXIge1xuICBzdHJpcGVTdWJtaXRSZWFkeSA9IGZhbHNlO1xuICBzY2FUcmlnZ2VyZWQgPSBmYWxzZTtcblxuICBzdHJpcGU7XG4gIGVsZW1lbnRzO1xuICBjYXJkTnVtYmVyO1xuICBjYXJkRXhwaXJ5O1xuICBjYXJkQ3ZjO1xuXG4gIHBheW1lbnRGaWVsZElkO1xuICBjdXJyZW5jeVNlbGVjdG9yO1xuICBhbW91bnRTZWxlY3RvcjtcbiAgcHVibGljS2V5O1xuICB1c2FnZTtcblxuICBmcmVlZm9ybTtcbiAgZm9ybTtcblxuICBzdHJpcGVMb2FkZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihmcmVlZm9ybSkge1xuICAgIGNvbnN0IHsgZm9ybSB9ID0gZnJlZWZvcm07XG4gICAgaWYgKGZvcm0uZGF0YXNldC5zdHJpcGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZnJlZWZvcm0gPSBmcmVlZm9ybTtcbiAgICB0aGlzLmZvcm0gPSBmb3JtO1xuXG4gICAgdGhpcy5wYXltZW50RmllbGRJZCA9IGZvcm0uZGF0YXNldC5zdHJpcGVQYXltZW50RmllbGRJZDtcbiAgICB0aGlzLmN1cnJlbmN5U2VsZWN0b3IgPSBmb3JtLmRhdGFzZXQuc3RyaXBlQ3VycmVuY3lTZWxlY3RvcjtcbiAgICB0aGlzLmFtb3VudFNlbGVjdG9yID0gZm9ybS5kYXRhc2V0LnN0cmlwZUFtb3VudFNlbGVjdG9yO1xuICAgIHRoaXMucHVibGljS2V5ID0gZm9ybS5kYXRhc2V0LnN0cmlwZVB1YmxpY0tleTtcbiAgICB0aGlzLnVzYWdlID0gZm9ybS5kYXRhc2V0LnN0cmlwZVVzYWdlO1xuXG4gICAgaWYgKCF0aGlzLl9pc1N0cmlwZVByZXNlbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBGb3JjZSBBSkFYIG9uIHRoZSBwYXltZW50IGZvcm1cbiAgICBmcmVlZm9ybS5zZXRPcHRpb24oJ2FqYXgnLCB0cnVlKTtcbiAgICBmcmVlZm9ybS5hZGRPblN1Ym1pdENhbGxiYWNrKHRoaXMuX2hhbmRsZVN1Ym1pdCk7XG4gICAgZnJlZWZvcm0uYWRkT25BZnRlckFqYXhTdWJtaXQodGhpcy5faGFuZGxlQWZ0ZXJTdWJtaXQpO1xuXG4gICAgdGhpcy5fbG9hZFN0cmlwZSgpO1xuXG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ3Jlc2V0JyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5jYXJkTnVtYmVyICYmIHRoaXMuY2FyZE51bWJlci5jbGVhcigpO1xuICAgICAgICB0aGlzLmNhcmRDdmMgJiYgdGhpcy5jYXJkQ3ZjLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuY2FyZEV4cGlyeSAmJiB0aGlzLmNhcmRFeHBpcnkuY2xlYXIoKTtcbiAgICAgIH0sXG4gICAgICBmYWxzZVxuICAgICk7XG4gIH1cblxuICBfaXNTdHJpcGVQcmVzZW50ID0gKCkgPT4ge1xuICAgIGNvbnN0IG51bWJlckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucGF5bWVudEZpZWxkSWQgKyAnX2NhcmRfbnVtYmVyJyk7XG5cbiAgICByZXR1cm4gbnVtYmVyRGl2ICE9PSBudWxsO1xuICB9O1xuXG4gIF9sb2FkU3RyaXBlID0gKCkgPT4ge1xuICAgIGlmICghd2luZG93LnN0cmlwZVNjcmlwdCkge1xuICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICBzY3JpcHQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHRoaXMuX2xvYWRDcmVkaXRDYXJkRmllbGRzKTtcbiAgICAgIHNjcmlwdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnN0cmlwZUxvYWRlZCA9IHRydWU7XG4gICAgICB9KTtcbiAgICAgIHNjcmlwdC5zcmMgPSAnaHR0cHM6Ly9qcy5zdHJpcGUuY29tL3YzLyc7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7XG5cbiAgICAgIHdpbmRvdy5zdHJpcGVTY3JpcHQgPSBzY3JpcHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RyaXBlTG9hZGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2xvYWRDcmVkaXRDYXJkRmllbGRzKCk7XG4gICAgfVxuICB9O1xuXG4gIF9oYW5kbGVTdWJtaXQgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLl9pc1N0cmlwZVByZXNlbnQoKSB8fCAhdGhpcy5zdHJpcGUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHRoaXMuZnJlZWZvcm0ubG9ja1N1Ym1pdCgpO1xuICAgIHRoaXMuZnJlZWZvcm0uX3JlbW92ZU1lc3NhZ2VzKCk7XG5cbiAgICBpZiAoIXRoaXMuc3RyaXBlTG9hZGVkKSB7XG4gICAgICBjb25zb2xlLmxvZygnU3RyaXBlIHNjcmlwdHMgbm90IGxvYWRlZCB5ZXQnKTtcbiAgICAgIHRoaXMuZnJlZWZvcm0udW5sb2NrU3VibWl0KCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRydWUgaWYgcGF5bWVudHMgaGF2ZSBiZWVuIHByb2Nlc3NlZCBhbmQgYXJlIHJlYWR5XG4gICAgaWYgKHRoaXMuc3RyaXBlU3VibWl0UmVhZHkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IGNhcmRGaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucGF5bWVudEZpZWxkSWQpO1xuXG4gICAgaWYgKHRoaXMudXNhZ2UgPT09ICdzaW5nbGVfdXNlJykge1xuICAgICAgdGhpcy5zdHJpcGUuY3JlYXRlUGF5bWVudE1ldGhvZCgnY2FyZCcsIHRoaXMuY2FyZE51bWJlciwge30pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dFcnJvcihyZXN1bHQuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICBjYXJkRmllbGQudmFsdWUgPSByZXN1bHQucGF5bWVudE1ldGhvZC5pZDtcbiAgICAgICAgdGhpcy5zdHJpcGVTdWJtaXRSZWFkeSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5mcmVlZm9ybS50cmlnZ2VyU3VibWl0KCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdHJpcGUuY3JlYXRlVG9rZW4odGhpcy5jYXJkTnVtYmVyKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9zaG93RXJyb3IocmVzdWx0LmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FyZEZpZWxkLnZhbHVlID0gcmVzdWx0LnRva2VuLmlkO1xuICAgICAgICB0aGlzLnN0cmlwZVN1Ym1pdFJlYWR5ID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmZyZWVmb3JtLnRyaWdnZXJTdWJtaXQoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBfaGFuZGxlQWZ0ZXJTdWJtaXQgPSAoZXZlbnQsIGZvcm0sIHJlc3BvbnNlKSA9PiB7XG4gICAgaWYgKCF0aGlzLl9pc1N0cmlwZVByZXNlbnQoKSB8fCAhdGhpcy5zdHJpcGUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChyZXNwb25zZS5hY3Rpb25zKSB7XG4gICAgICBjb25zdCBjYXJkRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnBheW1lbnRGaWVsZElkKTtcbiAgICAgIHJlc3BvbnNlLmFjdGlvbnMuZm9yRWFjaCgoYWN0aW9uKSA9PiB7XG4gICAgICAgIGlmIChhY3Rpb24ubmFtZSA9PT0gJ3N0cmlwZS5zaW5nbGVfcGF5bWVudC5wYXltZW50X2ludGVudF9hY3Rpb24nKSB7XG4gICAgICAgICAgY29uc3QgeyBwYXltZW50X2ludGVudCB9ID0gYWN0aW9uLm1ldGFkYXRhO1xuICAgICAgICAgIHRoaXMuc2NhVHJpZ2dlcmVkID0gdHJ1ZTtcblxuICAgICAgICAgIGNhcmRGaWVsZC52YWx1ZSA9IHBheW1lbnRfaW50ZW50LmlkO1xuXG4gICAgICAgICAgdGhpcy5zdHJpcGUuaGFuZGxlQ2FyZEFjdGlvbihwYXltZW50X2ludGVudC5jbGllbnRfc2VjcmV0LCB0aGlzLmNhcmROdW1iZXIsIHt9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgdGhpcy5zdHJpcGVTdWJtaXRSZWFkeSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2hvd0Vycm9yKHJlc3VsdC5lcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5mcmVlZm9ybS50cmlnZ2VyU3VibWl0KCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWN0aW9uLm5hbWUgPT09ICdzdHJpcGUuc3Vic2NyaXB0aW9uLnBheW1lbnRfaW50ZW50X2FjdGlvbicpIHtcbiAgICAgICAgICBjb25zdCB7IHN1YnNjcmlwdGlvbiwgcGF5bWVudF9pbnRlbnQgfSA9IGFjdGlvbi5tZXRhZGF0YTtcbiAgICAgICAgICB0aGlzLnNjYVRyaWdnZXJlZCA9IHRydWU7XG5cbiAgICAgICAgICBjYXJkRmllbGQudmFsdWUgPSBzdWJzY3JpcHRpb24uaWQ7XG5cbiAgICAgICAgICB0aGlzLnN0cmlwZS5oYW5kbGVDYXJkUGF5bWVudChwYXltZW50X2ludGVudC5jbGllbnRfc2VjcmV0LCBjYXJkTnVtYmVyLCB7fSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgIHRoaXMuc3RyaXBlU3VibWl0UmVhZHkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dFcnJvcihyZXN1bHQuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZnJlZWZvcm0udHJpZ2dlclN1Ym1pdCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX3Nob3dFcnJvciA9IChtZXNzYWdlKSA9PiB7XG4gICAgdGhpcy5mcmVlZm9ybS5fcmVuZGVyRm9ybUVycm9ycyhbbWVzc2FnZV0pO1xuICAgIHRoaXMuZnJlZWZvcm0udW5sb2NrU3VibWl0KCk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgX2xvYWRDcmVkaXRDYXJkRmllbGRzID0gKCkgPT4ge1xuICAgIGlmICghdGhpcy5faXNTdHJpcGVQcmVzZW50KCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBudW1iZXJEaXZJZCA9IHRoaXMucGF5bWVudEZpZWxkSWQgKyAnX2NhcmRfbnVtYmVyJztcbiAgICBjb25zdCBjdmNEaXZJZCA9IHRoaXMucGF5bWVudEZpZWxkSWQgKyAnX2NhcmRfY3ZjJztcbiAgICBjb25zdCBleHBpcnlEaXZJZCA9IHRoaXMucGF5bWVudEZpZWxkSWQgKyAnX2NhcmRfZXhwaXJ5JztcbiAgICBjb25zdCBudW1iZXJEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChudW1iZXJEaXZJZCk7XG4gICAgY29uc3QgY3ZjRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY3ZjRGl2SWQpO1xuICAgIGNvbnN0IGV4cGlyeURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV4cGlyeURpdklkKTtcbiAgICBjb25zdCBudW1iZXJQbGFjZWhvbGRlciA9IG51bWJlckRpdi5hdHRyaWJ1dGVzLnBsYWNlaG9sZGVyO1xuICAgIGNvbnN0IGV4cGlyeVBsYWNlaG9sZGVyID0gZXhwaXJ5RGl2LmF0dHJpYnV0ZXMucGxhY2Vob2xkZXI7XG4gICAgY29uc3QgY3ZjUGxhY2Vob2xkZXIgPSBjdmNEaXYuYXR0cmlidXRlcy5wbGFjZWhvbGRlcjtcblxuICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5mcmVlZm9ybS5fY3JlYXRlTmV3RXZlbnQoJ2ZyZWVmb3JtLXN0cmlwZS1zdHlsaW5nJyk7XG4gICAgZXZlbnQuZGV0YWlsID0ge307XG4gICAgdGhpcy5mb3JtLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuXG4gICAgY29uc3Qgc3R5bGUgPSBldmVudC5kZXRhaWw7XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgICB0aGlzLnN0cmlwZSA9IFN0cmlwZSh0aGlzLnB1YmxpY0tleSk7XG4gICAgdGhpcy5lbGVtZW50cyA9IHRoaXMuc3RyaXBlLmVsZW1lbnRzKCk7XG4gICAgdGhpcy5jYXJkTnVtYmVyID0gdGhpcy5lbGVtZW50cy5jcmVhdGUoJ2NhcmROdW1iZXInLCB7XG4gICAgICBwbGFjZWhvbGRlcjogbnVtYmVyUGxhY2Vob2xkZXIgPyBudW1iZXJQbGFjZWhvbGRlci52YWx1ZSA6ICcnLFxuICAgICAgc3R5bGUsXG4gICAgfSk7XG4gICAgdGhpcy5jYXJkRXhwaXJ5ID0gdGhpcy5lbGVtZW50cy5jcmVhdGUoJ2NhcmRFeHBpcnknLCB7XG4gICAgICBwbGFjZWhvbGRlcjogZXhwaXJ5UGxhY2Vob2xkZXIgPyBleHBpcnlQbGFjZWhvbGRlci52YWx1ZSA6ICcnLFxuICAgICAgc3R5bGUsXG4gICAgfSk7XG4gICAgdGhpcy5jYXJkQ3ZjID0gdGhpcy5lbGVtZW50cy5jcmVhdGUoJ2NhcmRDdmMnLCB7XG4gICAgICBwbGFjZWhvbGRlcjogY3ZjUGxhY2Vob2xkZXIgPyBjdmNQbGFjZWhvbGRlci52YWx1ZSA6ICcnLFxuICAgICAgc3R5bGUsXG4gICAgfSk7XG5cbiAgICB0aGlzLmNhcmROdW1iZXIubW91bnQoJyMnICsgbnVtYmVyRGl2SWQpO1xuICAgIHRoaXMuY2FyZEV4cGlyeS5tb3VudCgnIycgKyBleHBpcnlEaXZJZCk7XG4gICAgdGhpcy5jYXJkQ3ZjLm1vdW50KCcjJyArIGN2Y0RpdklkKTtcblxuICAgIHRoaXMuY2FyZE51bWJlci5vbignY2hhbmdlJywgdGhpcy5fcmVzZXRTdHJpcGVTdWJtaXQpO1xuICAgIHRoaXMuY2FyZEV4cGlyeS5vbignY2hhbmdlJywgdGhpcy5fcmVzZXRTdHJpcGVTdWJtaXQpO1xuICAgIHRoaXMuY2FyZEN2Yy5vbignY2hhbmdlJywgdGhpcy5fcmVzZXRTdHJpcGVTdWJtaXQpO1xuXG4gICAgdGhpcy5mcmVlZm9ybS5hZGRPbkFmdGVyQWpheFN1Ym1pdCgoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuc2NhVHJpZ2dlcmVkKSB7XG4gICAgICAgIHRoaXMuX3Jlc2V0U3RyaXBlU3VibWl0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNjYVRyaWdnZXJlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuYW1vdW50U2VsZWN0b3IpIHtcbiAgICAgIGNvbnN0IGFtb3VudElucHV0ID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5hbW91bnRTZWxlY3Rvcik7XG4gICAgICBpZiAoYW1vdW50SW5wdXQpIHtcbiAgICAgICAgYW1vdW50SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5fcmVzZXRTdHJpcGVTdWJtaXQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmN1cnJlbmN5U2VsZWN0b3IpIHtcbiAgICAgIGNvbnN0IGN1cnJlbmN5SW5wdXQgPSB0aGlzLmZvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLmN1cnJlbmN5U2VsZWN0b3IpO1xuICAgICAgaWYgKGN1cnJlbmN5SW5wdXQpIHtcbiAgICAgICAgY3VycmVuY3lJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLl9yZXNldFN0cmlwZVN1Ym1pdCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9yZXNldFN0cmlwZVN1Ym1pdCA9ICgpID0+IHtcbiAgICB0aGlzLnN0cmlwZVN1Ym1pdFJlYWR5ID0gZmFsc2U7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0cmlwZUhhbmRsZXI7XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///11\n")}});